{"version":3,"file":"index.js","sources":["../../../electron/main/index.ts"],"sourcesContent":["import { app, BrowserWindow, shell, ipcMain } from 'electron'\nimport { release } from 'os'\nimport { join } from 'path'\nconst spawn = require('child_process').spawn\n// Disable GPU Acceleration for Windows 7\nif (release().startsWith('6.1')) app.disableHardwareAcceleration()\n\n// Set application name for Windows 10+ notifications\nif (process.platform === 'win32') app.setAppUserModelId(app.getName())\n\nif (!app.requestSingleInstanceLock()) {\n  app.quit()\n  process.exit(0)\n}\n\n// Remove electron security warnings\n// This warning only shows in development mode\n// Read more on https://www.electronjs.org/docs/latest/tutorial/security\n// process.env['ELECTRON_DISABLE_SECURITY_WARNINGS'] = 'true'\n\nexport const ROOT_PATH = {\n  // /dist\n  dist: join(__dirname, '../..'),\n  // /dist or /public\n  public: join(__dirname, app.isPackaged ? '../..' : '../../../public'),\n}\n\nlet win: BrowserWindow | null = null\n// Here, you can also use other preload\nconst preload = join(__dirname, '../preload/index.js')\nconst url = 'http://localhost:3000'\nconst indexHtml = join(ROOT_PATH.dist, 'index.html')\n\nasync function createWindow() {\n  win = new BrowserWindow({\n    title: 'Main window',\n    icon: join(ROOT_PATH.public, 'favicon.ico'),\n    webPreferences: {\n      preload,\n      // Warning: Enable nodeIntegration and disable contextIsolation is not secure in production\n      // Consider using contextBridge.exposeInMainWorld\n      // Read more on https://www.electronjs.org/docs/latest/tutorial/context-isolation\n      nodeIntegration: true,\n      contextIsolation: false,\n    },\n  })\n\n\n  win.loadURL(url)\n  win.webContents.openDevTools()\n\n  // Test actively push message to the Electron-Renderer\n  win.webContents.on('did-finish-load', () => {\n    win?.webContents.send('main-process-message', new Date().toLocaleString())\n  })\n\n  // Make all links open with the browser, not with the application\n  win.webContents.setWindowOpenHandler(({ url }) => {\n    if (url.startsWith('https:')) shell.openExternal(url)\n    return { action: 'deny' }\n  })\n}\n\napp.whenReady().then(spawn('yarn', ['graphql-dev'])\n  .stdout.on('spawn', (data) => {console.log(data)})\n  .on('error', (err) => { console.log(err ); throw err }))\n.then(createWindow)\n\napp.on('window-all-closed', () => {\n  win = null\n  if (process.platform !== 'darwin') app.quit()\n})\n\napp.on('second-instance', () => {\n  if (win) {\n    // Focus on the main window if the user tried to open another\n    if (win.isMinimized()) win.restore()\n    win.focus()\n  }\n})\n\napp.on('activate', () => {\n  const allWindows = BrowserWindow.getAllWindows()\n  if (allWindows.length) {\n    allWindows[0].focus()\n  } else {\n    createWindow()\n  }\n})\n\n// new window example arg: new windows url\nipcMain.handle('open-win', (event, arg) => {\n  const childWindow = new BrowserWindow({\n    webPreferences: {\n      preload,\n    },\n  })\n\n  if (app.isPackaged) {\n    childWindow.loadFile(indexHtml, { hash: arg })\n  } else {\n    childWindow.loadURL(`${url}/#${arg}`)\n    childWindow.webContents.openDevTools({ mode: \"undocked\", activate: true })\n  }\n})\n"],"names":["release","app","join","BrowserWindow","shell","ipcMain"],"mappings":"wKAGA,KAAM,GAAQ,QAAQ,eAAe,EAAE,MAEvC,AAAIA,UAAU,EAAA,WAAW,KAAK,GAAGC,EAAA,IAAI,4BAA4B,EAGjE,AAAI,QAAQ,WAAa,SAAaA,EAAAA,IAAA,kBAAkBA,MAAI,QAAS,CAAA,EAErE,AAAKA,EAAAA,IAAI,6BACPA,GAAA,IAAI,KAAK,EACT,QAAQ,KAAK,CAAC,GAQT,KAAM,GAAY,CAEvB,KAAMC,EAAAA,KAAK,UAAW,OAAO,EAE7B,OAAQA,EAAK,KAAA,UAAWD,EAAI,IAAA,WAAa,QAAU,iBAAiB,CACtE,EAEA,GAAI,GAA4B,KAEhC,KAAM,GAAUC,EAAK,KAAA,UAAW,qBAAqB,EAC/C,EAAM,wBACN,EAAYA,EAAAA,KAAK,EAAU,KAAM,YAAY,EAEnD,kBAA8B,CAC5B,EAAM,GAAIC,GAAAA,cAAc,CACtB,MAAO,cACP,KAAMD,EAAA,KAAK,EAAU,OAAQ,aAAa,EAC1C,eAAgB,CACd,UAIA,gBAAiB,GACjB,iBAAkB,EACpB,CAAA,CACD,EAGD,EAAI,QAAQ,CAAG,EACf,EAAI,YAAY,eAGZ,EAAA,YAAY,GAAG,kBAAmB,IAAM,CAC1C,WAAK,YAAY,KAAK,uBAAwB,GAAI,MAAK,EAAE,iBAAgB,CAC1E,EAGD,EAAI,YAAY,qBAAqB,CAAC,CAAE,IAAU,KAC5C,GAAI,WAAW,QAAQ,GAAGE,QAAM,aAAa,CAAG,EAC7C,CAAE,OAAQ,QAClB,CACH,CAEAH,EAAA,IAAI,UAAU,EAAE,KAAK,EAAM,OAAQ,CAAC,aAAa,CAAC,EAC/C,OAAO,GAAG,QAAS,AAAC,GAAS,CAAC,QAAQ,IAAI,CAAI,CAAC,CAAC,EAChD,GAAG,QAAS,AAAC,GAAQ,CAAE,cAAQ,IAAI,CAAI,EAAS,CAAI,CAAC,CAAC,EACxD,KAAK,CAAY,EAElBA,EAAAA,IAAI,GAAG,oBAAqB,IAAM,CAC1B,EAAA,KACF,QAAQ,WAAa,UAAUA,EAAA,IAAI,KAAK,CAC9C,CAAC,EAEDA,EAAAA,IAAI,GAAG,kBAAmB,IAAM,CAC9B,AAAI,GAEE,GAAI,YAAY,GAAG,EAAI,QAAQ,EACnC,EAAI,MAAM,EAEd,CAAC,EAEDA,EAAAA,IAAI,GAAG,WAAY,IAAM,CACjB,KAAA,GAAaE,gBAAc,gBACjC,AAAI,EAAW,OACb,EAAW,GAAG,QAED,GAEjB,CAAC,EAGDE,EAAA,QAAQ,OAAO,WAAY,CAAC,EAAO,IAAQ,CACnC,KAAA,GAAc,GAAIF,iBAAc,CACpC,eAAgB,CACd,SACF,CAAA,CACD,EAED,AAAIF,EAAAA,IAAI,WACN,EAAY,SAAS,EAAW,CAAE,KAAM,CAAK,CAAA,EAEjC,GAAA,QAAQ,GAAG,MAAQ,GAAK,EACpC,EAAY,YAAY,aAAa,CAAE,KAAM,WAAY,SAAU,GAAM,EAE7E,CAAC"}